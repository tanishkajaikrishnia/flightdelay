import math

AIRPORT_COORDS = {
    'ABE': (40.651773, -75.442797),
    'ABI': (32.4113006592, -99.6819000244),
    'ABQ': (35.039976, -106.608925),
    'ABY': (31.532946, -84.196215),
    'ACT': (31.611299514770508, -97.23049926757812),
    'ACV': (40.978101, -124.109),
    'ACY': (39.45759963989258, -74.57720184326172),
    'AEX': (31.3274, -92.549797),
    'AGS': (33.3699, -81.9645),
    'ALB': (42.74829864501953, -73.80169677734375),
    'AMA': (35.219398, -101.706001),
    'ASE': (39.223202, -106.869003),
    'ATL': (33.6367, -84.428101),
    'ATW': (44.258099, -88.519096),
    'AUS': (30.197535, -97.662015),
    'AVL': (35.436199, -82.541801),
    'AVP': (41.3385009766, -75.72339630130001),
    'AZO': (42.234901428222656, -85.5521011352539),
    'BDL': (41.93851, -72.688066),
    'BFL': (35.433601, -119.056999),
    'BGR': (44.8074, -68.828102),
    'BHM': (33.562901, -86.753502),
    'BIL': (45.807701, -108.542999),
    'BIS': (46.77270126342773, -100.74600219726562),
    'BLI': (48.79280090332031, -122.53800201416016),
    'BMI': (40.4771, -88.915901),
    'BNA': (36.1245, -86.6782),
    'BOI': (43.5644, -116.223),
    'BOS': (42.36197, -71.0079),
    'BQK': (31.258801, -81.466499),
    'BTM': (45.95479965209961, -112.49700164794922),
    'BTR': (30.533199, -91.149597),
    'BTV': (44.471901, -73.153297),
    'BUF': (42.940498, -78.732201),
    'BUR': (34.197703, -118.356378),
    'BWI': (39.1754, -76.668297),
    'BZN': (45.7775, -111.153),
    'CAE': (33.938801, -81.119499),
    'CAK': (40.91609954833984, -81.44219970703125),
    'CDC': (37.70100021362305, -113.0989990234375),
    'CEC': (41.778929, -124.236403),
    'CHA': (35.035301, -85.203796),
    'CHO': (38.13859939575195, -78.4529037475586),
    'CHS': (32.898602, -80.040497),
    'CIC': (39.795595, -121.857716),
    'CID': (41.884701, -91.7108),
    'CLE': (41.411701, -81.8498),
    'CLL': (30.5886, -96.3638),
    'CLT': (35.2140007019043, -80.94309997558594),
    'CMH': (39.998001, -82.891899),
    'CMI': (40.039819, -88.276249),
    'COD': (44.520199, -109.024002),
    'COS': (38.805801, -104.700996),
    'CPR': (42.908001, -106.463997),
    'CRP': (27.770399, -97.501198),
    'CLD': (33.1283, -117.279999),
    'CRW': (38.3731, -81.593201),
    'CSG': (32.516300201416016, -84.93890380859375),
    'CVG': (39.048801, -84.667801),
    'CWA': (44.777448, -89.670238),
    'DAB': (29.179899, -81.058098),
    'DAL': (32.847099, -96.851799),
    'DAY': (39.902401, -84.219398),
    'DBQ': (42.402, -90.709503),
    'DCA': (38.8521, -77.037697),
    'DEN': (39.861698150635, -104.672996521),
    'DFW': (32.896801, -97.038002),
    'DHN': (31.3213005065918, -85.44960021972656),
    'DRO': (37.151501, -107.753998),
    'DSM': (41.534, -93.663101),
    'DTW': (42.21377, -83.353786),
    'EGE': (39.64260101, -106.9179993),
    'EKO': (40.82490158081055, -115.79199981689452),
    'ELP': (31.807199, -106.377998),
    'EUG': (44.12459945678711, -123.21199798583984),
    'EVV': (38.0369987488, -87.5324020386),
    'EWN': (35.0730018616, -77.04290008539999),
    'EWR': (40.692501, -74.168701),
    'EYW': (24.556101, -81.759598),
    'FAR': (46.92070007324219, -96.81580352783205),
    'FAT': (36.776199, -119.718002),
    'FAY': (34.991199, -78.880302),
    'FLL': (26.072599, -80.152702),
    'FLO': (34.18539810180664, -79.7238998413086),
    'FNT': (42.96540069580078, -83.74359893798828),
    'FSD': (43.585463, -96.741152),
    'FSM': (35.336601, -94.367401),
    'FWA': (40.9785, -85.195099),
    'GEG': (47.6199, -117.533997),
    'GGG': (32.38399887084961, -94.71150207519533),
    'GJT': (39.126663, -108.529387),
    'GNV': (29.6900997162, -82.2717971802),
    'FCA': (48.31050109863281, -114.25599670410156),
    'GPT': (30.407301, -89.070099),
    'GRB': (44.483459, -88.130805),
    'GRK': (31.0672, -97.828903),
    'GRR': (42.88079834, -85.52279663),
    'GSO': (36.097801, -79.937302),
    'GSP': (34.895699, -82.218903),
    'GTF': (47.48199844, -111.3710022),
    'GTR': (33.450298, -88.5914),
    'GUC': (38.534672, -106.934566),
    'HDN': (40.481201, -107.218002),
    'HLN': (46.6068, -111.983002),
    'HOU': (29.645399, -95.2789),
    'HPN': (41.06700134277344, -73.70760345458984),
    'HRL': (26.228500366210938, -97.65440368652344),
    'HSV': (34.637199, -86.775101),
    'HHH': (32.2244, -80.697502),
    'IAD': (38.9445, -77.455803),
    'IAH': (29.984399795532227, -95.34140014648438),
    'ICT': (37.649899, -97.433098),
    'IDA': (43.514599, -112.070999),
    'ILM': (34.270599365234375, -77.90260314941406),
    'IND': (39.7173, -86.294403),
    'IPL': (32.83539, -115.574026),
    'ISP': (40.79520035, -73.10019684),
    'IYK': (35.65879822, -117.8300018),
    'JAC': (43.6072998046875, -110.73799896240234),
    'JAN': (32.311199, -90.075897),
    'JAX': (30.492469, -81.687813),
    'JFK': (40.639447, -73.779317),
    'LAN': (42.77870178222656, -84.58740234375),
    'LAS': (36.083361, -115.151817),
    'LAW': (34.567699, -98.416603),
    'LAX': (33.942501, -118.407997),
    'LBB': (33.663601, -101.822998),
    'LEX': (38.036499, -84.605904),
    'LFT': (30.205299, -91.987602),
    'LGA': (40.777199, -73.872597),
    'LGB': (33.816523, -118.149891),
    'LIT': (34.729582, -92.223728),
    'LNK': (40.85100173950195, -96.75920104980467),
    'LRD': (27.543800354003903, -99.46160125732422),
    'LSE': (43.879002, -91.256699),
    'LWB': (37.857914, -80.400438),
    'LWS': (46.3745002746582, -117.01499938964844),
    'LYH': (37.326698, -79.200401),
    'MAF': (31.942499, -102.202003),
    'MBS': (43.531913, -84.082275),
    'MCI': (39.2976, -94.713898),
    'MCN': (32.69279861450195, -83.64920043945312),
    'MCO': (28.429399490356445, -81.30899810791016),
    'MDT': (40.193501, -76.763397),
    'MDW': (41.785999, -87.752403),
    'MEI': (32.3326, -88.7519),
    'MEM': (35.0424, -89.9767),
    'MFE': (26.176141, -98.237965),
    'MFR': (42.37419891357422, -122.8730010986328),
    'MGM': (32.300598, -86.393997),
    'MHT': (42.932598, -71.435699),
    'MIA': (25.79319953918457, -80.29060363769531),
    'MKE': (42.947201, -87.896599),
    'MKG': (43.169498, -86.238197),
    'MLB': (28.1028, -80.645302),
    'MLI': (41.448502, -90.5075),
    'MLU': (32.510899, -92.037697),
    'MOB': (30.6912, -88.242798),
    'MOD': (37.625801, -120.954002),
    'MRY': (36.58700180053711, -121.84300231933594),
    'MSN': (43.1399, -89.337502),
    'MSO': (46.91630173, -114.0910034),
    'MSP': (44.880081, -93.221741),
    'MSY': (29.993401, -90.258003),
    'MTJ': (38.5098, -107.893997),
    'MYR': (33.679699, -78.928299),
    'YUM': (32.650938, -114.609375),
    'OAJ': (34.829201, -77.612099),
    'OAK': (37.720085, -122.221184),
    'OKC': (35.393388, -97.598248),
    'OMA': (41.3032, -95.894096),
    'ONT': (34.056, -117.600998),
    'ORD': (41.9786, -87.9048),
    'ORF': (36.895341, -76.201),
    'OXR': (34.200801849365, -119.20700073242),
    'PBI': (26.683201, -80.095596),
    'PDX': (45.588699, -122.598),
    'PHF': (37.131901, -76.492996),
    'PHL': (39.871899, -75.241096),
    'PHX': (33.435302, -112.005905),
    'PIA': (40.6642, -89.693298),
    'PIH': (42.9098014831543, -112.59600067138672),
    'PIT': (40.491501, -80.232903),
    'PMD': (34.629398, -118.084999),
    'PNS': (30.4734, -87.1866),
    'PSC': (46.264702, -119.119003),
    'PSP': (33.8297, -116.507004),
    'PVD': (41.725038, -71.425668),
    'PWM': (43.646198, -70.309303),
    'RAP': (44.0452995300293, -103.05699920654295),
    'RDD': (40.50899887, -122.2929993),
    'RDM': (44.254101, -121.150002),
    'RDU': (35.877602, -78.787498),
    'RFD': (42.1954, -89.097198),
    'RIC': (37.505199, -77.319702),
    'RNO': (39.4991, -119.767998),
    'ROA': (37.3255, -79.975403),
    'ROC': (43.1189, -77.672401),
    'ROW': (33.301601, -104.530998),
    'RST': (43.908298, -92.5),
    'RSW': (26.53619956970215, -81.75520324707031),
    'SAN': (32.7336006165, -117.190002441),
    'SAT': (29.533701, -98.469803),
    'SAV': (32.127602, -81.202103),
    'MQT': (46.3536, -87.395401),
    'SBA': (34.426201, -119.839996),
    'SBN': (41.708698, -86.317299),
    'SBP': (35.2368011475, -120.641998291),
    'SDF': (38.1744, -85.736),
    'SEA': (47.447943, -122.310276),
    'SFO': (37.619806, -122.374821),
    'SGF': (37.245701, -93.388603),
    'SGU': (37.036389, -113.510306),
    'SHV': (32.446602, -93.8256),
    'SJC': (37.362452, -121.929188),
    'SJT': (31.35770034790039, -100.49600219726562),
    'SLC': (40.78886, -111.979866),
    'SLE': (44.9095, -123.002998),
    'SMF': (38.6954, -121.591003),
    'SMX': (34.898899, -120.457001),
    'SNA': (33.675701, -117.867996),
    'SPI': (39.844101, -89.677902),
    'SPS': (33.9888, -98.491898),
    'SRQ': (27.394631, -82.554359),
    'STL': (38.748697, -90.370003),
    'SUN': (43.50439835, -114.2959976),
    'SWF': (41.504101, -74.104797),
    'SYR': (43.11119842529297, -76.1063003540039),
    'TLH': (30.3965, -84.350304),
    'TOL': (41.5868, -83.8078),
    'TPA': (27.9755, -82.533203),
    'TRI': (36.475201, -82.407401),
    'TUL': (36.19839859008789, -95.88809967041016),
    'TUS': (32.115004, -110.938053),
    'TVC': (44.74140167236328, -85.58219909667969),
    'TWF': (42.4818, -114.487999),
    'TXK': (33.453701, -93.990997),
    'TYR': (32.35409927368164, -95.40239715576172),
    'TYS': (35.811001, -83.994003),
    'SCE': (40.849374, -77.84852),
    'VLD': (30.78249931335449, -83.27670288085938),
    'VPS': (30.4832, -86.525398),
    'WYS': (44.6884, -111.117996),
    'XNA': (36.281898, -94.306801),
    'YKM': (46.56819916, -120.5439987),
    'BET': (60.77980042, -161.8379974),
    'BRW': (71.285402, -156.766008),
    'CDV': (60.491798, -145.477997),
    'ADK': (51.883564, -176.642783),
    'DLG': (59.04470062, -158.5050049),
    'ADQ': (57.75, -152.4940033),
    'FAI': (64.815102, -147.856003),
    'JNU': (58.355, -134.576004),
    'AKN': (58.677845, -156.651965),
    'KTN': (55.35559845, -131.7140045),
    'ANC': (61.179004, -149.992561),
    'OME': (64.51219940185547, -165.44500732421875),
    'OTZ': (66.88469696, -162.598999),
    'PSG': (56.80170059, -132.9450073),
    'SCC': (70.19470215, -148.4649963),
    'SIT': (57.04710006713867, -135.36199951171875),
    'WRG': (56.48429871, -132.3699951),
    'YAK': (59.508717, -139.660435),
    'KOA': (19.738783, -156.045603),
    'LIH': (21.976, -159.339005),
    'HNL': (21.32062, -157.924228),
    'OGG': (20.896263, -156.431837),
    'ITO': (19.721399, -155.048004),
    'STT': (18.337091, -64.977251),
    'STX': (17.701413, -64.802608),
    'BQN': (18.4949, -67.129402),
    'PSE': (18.00830078125, -66.56300354003906),
    'SJU': (18.4394, -66.001801),
}

def haversine(coord1, coord2):
    """Return distance in miles between two (lat, lon) pairs."""
    R = 3958.8  # Earth radius in miles
    lat1, lon1 = map(math.radians, coord1)
    lat2, lon2 = map(math.radians, coord2)
    dlat = lat2 - lat1
    dlon = lon2 - lon1
    a = math.sin(dlat/2)**2 + math.cos(lat1)*math.cos(lat2)*math.sin(dlon/2)**2
    c = 2 * math.asin(math.sqrt(a))
    return R * c

def get_distance_miles(origin, dest):
    """Return the distance in miles between two IATA codes, or None if missing."""
    coord_o = AIRPORT_COORDS.get(origin)
    coord_d = AIRPORT_COORDS.get(dest)
    if coord_o is None or coord_d is None:
        return None
    return haversine(coord_o, coord_d)
